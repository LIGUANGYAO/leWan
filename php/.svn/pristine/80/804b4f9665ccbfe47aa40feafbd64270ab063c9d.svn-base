<link rel="stylesheet" href="/static/layui/css/layui2.0.css" type="text/css">
<div class="page">
<div class="layui-field-title"></div>

<form class="layui-form" action="{:url('Orderconsumecode/ConsumeCodeList')}">
    <input type="text" name="status" value="{$status}" hidden="hidden">

    <div class="layui-form-item ">
        <div class="layui-input-block layui-col-sm4">
            <input type="text" name="title"  placeholder="商户名/用户昵称/联系电话/平台订单号/消费码"  class="layui-input" value="{$query['title']}">
        </div>

        <if condition="$status eq 0">
            <label class="layui-form-label">使用状态:</label>
            <div class="layui-input-inline ">
                <select name="type" lay-verify="require">
                    <option value="0">全部状态</option>
                    <option value="1" <if condition="$query['type'] eq 1"> selected="selected"</if>>未使用</option>
                    <option value="2" <if condition="$query['type'] eq 2"> selected="selected"</if>>已使用</option>
                    <option value="3" <if condition="$query['type'] eq 3"> selected="selected"</if>>已过期</option>
                    <option value="4" <if condition="$query['type'] eq 4"> selected="selected"</if>>已冻结</option>
                </select>
            </div>
        </if>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">更新时间:</label>
        <div class="layui-input-inline">
            <input class="layui-input" name="upstarttime" value="{$query['upstarttime']}" placeholder="开始时间" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
        </div>
        <div class="layui-input-inline">
            <input class="layui-input" name="upendtime" value="{$query['upendtime']}" placeholder="结束时间" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
        </div>

        <label class="layui-form-label">加入时间:</label>
        <div class="layui-input-inline">
            <input class="layui-input" name="starttime" value="{$query['starttime']}" placeholder="开始时间" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
        </div>
        <div class="layui-input-inline">
            <input class="layui-input" name="endtime" value="{$query['endtime']}" placeholder="结束时间" onclick="layui.laydate({elem: this, istime: true, format: 'YYYY-MM-DD hh:mm:ss'})">
        </div>
        <!--<label class="layui-form-label"></label>-->
        <span class="input-group-btn layui-input-block">
              <button type="reset" class="layui-btn layui-btn-primary">重置</button>
              <button type="submit" class="layui-btn "><i class="fa fa-search"></i> 搜索</button>
        </span>
    </div>
</form>

<div class="clear"></div>
<div class="layui-field-title"></div>

<div class="layui-input-block">
    <div class="layui-btn-group search">
        <a href="{:url('Orderconsumecode/ConsumeCodeList',array('status'=>0))}">
            <button class="layui-btn <if condition="$status eq 0">layui-btn-normal<else />layui-btn-primary</if>">全部消费码 ({$count["whole"]})</button></a>
        <a href="{:url('Orderconsumecode/ConsumeCodeList',array('status'=>1))}">
            <button class="layui-btn <if condition="$status eq 1">layui-btn-normal<else />layui-btn-primary</if>">未使用 ({$count["notused"]})</button></a>
        <a href="{:url('Orderconsumecode/ConsumeCodeList',array('status'=>2))}">
            <button class="layui-btn <if condition="$status eq 2">layui-btn-normal<else />layui-btn-primary</if>">已使用 ({$count["alreadyused"]})</button></a>
        <a href="{:url('Orderconsumecode/ConsumeCodeList',array('status'=>3))}">
            <button class="layui-btn <if condition="$status eq 3">layui-btn-normal<else />layui-btn-primary</if>">已过期 ({$count["expired"]})</button></a>
        <a href="{:url('Orderconsumecode/ConsumeCodeList',array('status'=>4))}">
            <button class="layui-btn <if condition="$status eq 4">layui-btn-normal<else />layui-btn-primary</if>">已冻结 ({$count["frozen"]})</button></a>
    </div>
</div>

<div class="clear"></div>
<div class="layui-field-title"></div>
<!-- 模板样式 -->
<div class="layui-form">
    <if condition="$data.list">
        <table class="layui-table">
            <thead>
            <tr>
                <if condition="in_array($status,array(0,1,4))">
                    <th nowrap="nowrap" width="20"><input type="checkbox" name="" lay-skin="primary" lay-filter="allChoose"></th>
                </if>
                <th width="200">商户</th>
                <th width="200">用户信息</th>
                <th width="150">平台订单号</th>
                <th width="150">消费码</th>
                <th width="80">使用状态</th>
                <th width="120">更新时间</th>
                <th width="120">录入时间</th>
            </tr>
            </thead>
            <tbody>
            <volist name="$data.list" id="val">
                <tr>
                    <if condition="in_array($status,array(0,1,4))">
                        <td nowrap="nowrap">
                            <if condition="$val.status eq 1 or $val.status eq 4">
                                <input type="checkbox" name="id[]" value="{$val.consume_code_id}" lay-skin="primary" lay-filter="idchoose">
                            </if>
                        </td>
                    </if>
                    <td >
                        主店商家:{$val.merchant_name}<br>
                        预约商家:{$val.merchant_cname}
                    </td>
                    <td >
                        微信昵称:{$val.nickname}<br>
                        注册账号:{$val.mobile}<br>
                        订单昵称:{$val.order_fullname}<br>
                        订单电话:{$val.order_mobile}
                    </td>
                    <td >{$val.order_no}</td>
                    <td >{$val.consume_code}</td>
                    <td >
                        <label class="layui-badge {$val.statuscss}"> {$val.statusname}</label>
                    </td>
                    <td >
                        <if condition="!empty($val.uptime)">
                            {$val.uptime|date='Y-m-d H:i',###}
                        </if>
                    </td>
                    <td >{$val.addtime|date='Y-m-d H:i',###}</td>
                </tr>
            </volist>
            </tbody>
        </table>
        <else />
        <div class="layui-field-title"></div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                暂无数据w(ﾟДﾟ)w
            </div>
        </div>
    </if>

    <div class="layui-form-item">
        <div class="l">
            <a href="javascript:batchDel('/system/Orderconsumecode/ConsumeCodeBatch','确定批量冻结消费码',1)" class="layui-btn batchdel layui-btn-danger layui-btn-disabled">批量冻结</a>
        </div>
        &nbsp;
        <div class="l">
            <a href="javascript:batchDel('/system/Orderconsumecode/ConsumeCodeBatch','确定批量解冻消费码?',2);" msg="111" class="layui-btn batchdel layui-btn-small layui-btn-disabled">批量解冻</a>
        </div>
    </div>

    <div class="tabletool">
        <!-- 分页工具 -->
        <div id="limitpage" class="l"></div>
        <div class="clear"></div>
    </div>
</div>

</div>
</div>
<script>

</script>